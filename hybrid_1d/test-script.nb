(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44850,       1209]
NotebookOptionsPosition[     43491,       1163]
NotebookOutlinePosition[     43849,       1179]
CellTagsIndexPosition[     43806,       1176]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/Downloads/Test1\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell["Energy", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"\"\<energy.csv\>\"", ",", "\"\<CSV\>\"", ",", 
             RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], "//", 
           "Transpose"}]}], ",", "step", ",", "time", ",", "dB2O2", ",", 
         "dE2O2", ",", "mv2O2", ",", "mU2O2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "mU2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<mU2O2\>\"", "->", "mU2O2"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"energy", "=", "energy"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dB2O2", "=", 
       RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dE2O2", "=", 
       RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}], "//", "Total"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"dB2O2", "//", "Transpose"}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}]}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"dE2O2", "//", "Transpose"}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"mv2O2", "//", "Transpose"}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}]}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"#2", "-", 
                 RowBox[{"First", "[", "#2", "]"}]}], ",", 
                RowBox[{"#", "+", "#2", "-", 
                 RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Plus", "@@@", 
                RowBox[{"(", 
                 RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
               RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"energy", "=", "energy"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", ",", "plots"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"energy", "[", "\"\<mU2O2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"mv2O2", "-", "mU2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "//", "Transpose"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], "&"}], "/@", 
            "mv2O2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "//", "Transpose"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], "&"}], "/@", 
            "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "//", "Transpose"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], "&"}], "/@", 
            "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"energy", "=", "energy"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}], "-", 
        RowBox[{"energy", "[", "\"\<mU2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Rest", "[", "#", "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"m\[Theta]2O2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{"m\[Theta]2O2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", "\"\<T_par(t)/T_par(0)\>\""}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", "\"\<T_per(t)/T_par(0)\>\""}], 
            ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field", "Section"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "readMetadata", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readMetadata", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./moment-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fd", ",", "meta"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fd", "=", 
        RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"meta", "=", 
        RowBox[{"ReadLine", "[", "fd", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "fd", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ToExpression", "[", "#2", "]"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"StringTrim", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<=\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"meta", "~", "StringReplace", "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<e-\>\"", "\[Rule]", "\"\<*^-\>\""}], ",", 
                RowBox[{"\"\<e+\>\"", "\[Rule]", "\"\<*^\>\""}]}], "}"}]}], 
             ",", "\"\<;\>\""}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importer", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./field-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
            RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "2"}]}], "]"}], "//", 
          "Transpose"}]}], ",", "dE", ",", "dB", ",", "meta"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dB", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<dB\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "dB"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<dE\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "dE"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<field-*.csv\>\"", ",", "\"\<.\>\""}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"path", ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StringCases", "[", 
              RowBox[{"s", ",", 
               RowBox[{
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importer", "[", "paths", "]"}], "]"}], ",", "Identity"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", "assoc"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "field"}]], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"field", "=", "field"}], ",", 
     RowBox[{"scale", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xlim", ",", "tlim", ",", "dB2", ",", "dB3", ",", "max", ",", "plots"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xlim", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"field", "[", "\"\<Nx\>\"", "]"}]}], "}"}], 
        RowBox[{"field", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlim", "=", 
       RowBox[{"field", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<time\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dB2", "=", 
       RowBox[{"field", "[", "\"\<dB2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dB3", "=", 
       RowBox[{"field", "[", "\"\<dB3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"{", 
          RowBox[{"dB2", ",", "dB3"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dB2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dB2", "*", 
           RowBox[{"scale", "/", "max"}]}], "+", "1"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dB3", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dB3", "*", 
           RowBox[{"scale", "/", "max"}]}], "+", "1"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<time\>\""}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"dB2", "//", "Reverse"}], ",", 
            RowBox[{"DataRange", "->", 
             RowBox[{"{", 
              RowBox[{"xlim", ",", "tlim"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<dB_perp\>\""}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"dB3", "//", "Reverse"}], ",", 
            RowBox[{"DataRange", "->", 
             RowBox[{"{", 
              RowBox[{"xlim", ",", "tlim"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<dB_z\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Row", "[", "plots", "]"}], ",", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"BarLegend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<TemperatureMap\>\"", ",", 
              RowBox[{
               RowBox[{"max", "/", "scale"}], 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
            RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",", 
          "Bottom"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"field", "=", "field"}], ",", 
     RowBox[{"kmax", "=", "3"}], ",", 
     RowBox[{"\[Omega]max", "=", "3"}], ",", 
     RowBox[{"decade", "=", "7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Nx", ",", "Dx"}], "}"}], ",", 
        RowBox[{"N", "@", 
         RowBox[{"Times", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Range", "[", "Nx", "]"}], "-", "1"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$_Integer", "/;", 
               RowBox[{"$", "\[GreaterEqual]", 
                RowBox[{"Nx", "/", "2"}]}]}], "\[RuleDelayed]", 
              RowBox[{"$", "-", "Nx"}]}], "}"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"Pi", "/", 
             RowBox[{"(", 
              RowBox[{"Nx", " ", "Dx"}], ")"}]}]}]}], "]"}]}]}], "]"}]}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kx", ",", "posk", ",", "\[Omega]t", ",", "pos\[Omega]", ",", "dB3", 
       ",", "dB2", ",", "max", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kx", "=", 
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"field", "[", "\"\<Nx\>\"", "]"}], ",", 
         RowBox[{"field", "[", "\"\<Dx\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", "posk"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"kx", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "kx", "]"}], "]"}]}], "}"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"$_Real", "/;", 
             RowBox[{
              RowBox[{"Abs", "[", "$", "]"}], "\[LessEqual]", "kmax"}]}], ",",
             "_Integer"}], "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posk", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"List", "/@", "posk"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]t", "=", 
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"field", "[", "\"\<time\>\"", "]"}], "//", "Length"}], ",", 
         
         RowBox[{"Subtract", "@@", 
          RowBox[{"field", "[", 
           RowBox[{"[", 
            RowBox[{"\"\<time\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]t", ",", "pos\[Omega]"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\[Omega]t", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "\[Omega]t", "]"}], "]"}]}], "}"}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"$_Real", "/;", 
             RowBox[{
              RowBox[{"Abs", "[", "$", "]"}], "\[LessEqual]", 
              "\[Omega]max"}]}], ",", "_Integer"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos\[Omega]", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"List", "/@", "pos\[Omega]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dB3", "=", 
       RowBox[{
        RowBox[{"posk", "/@", 
         RowBox[{"pos\[Omega]", "@", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"Fourier", "[", 
              RowBox[{"field", "[", "\"\<dB3\>\"", "]"}], "]"}]}], ",", "2"}],
            "]"}]}]}], "//", "Log10"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dB2", "=", 
       RowBox[{
        RowBox[{"posk", "/@", 
         RowBox[{"pos\[Omega]", "@", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"Fourier", "[", 
              RowBox[{"field", "[", "\"\<dB2\>\"", "]"}], "]"}]}], ",", "2"}],
            "]"}]}]}], "//", "Log10"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"dB2", ",", "dB3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dB3", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dB3", "-", "max"}], ")"}], "/", "decade"}], "+", "1"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dB2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dB2", "-", "max"}], ")"}], "/", "decade"}], "+", "1"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<k\>\"", ",", "\"\<\[Omega]\>\""}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"dB2", "//", "Reverse"}], ",", 
            RowBox[{"DataRange", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kx", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
               RowBox[{"\[Omega]t", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<log10|dB_perp^2|\>\""}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"dB3", "//", "Reverse"}], ",", 
            RowBox[{"DataRange", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"kx", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
               RowBox[{"\[Omega]t", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<log10|dB_z^2|\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Row", "[", "plots", "]"}], ",", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"BarLegend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Rainbow\>\"", ",", 
              RowBox[{"max", "+", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "decade"}], ",", "0"}], "}"}]}]}], "}"}], ",", 
            RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",", 
          "Bottom"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Section"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "readMetadata", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readMetadata", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./moment-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fd", ",", "meta"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fd", "=", 
        RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"meta", "=", 
        RowBox[{"ReadLine", "[", "fd", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "fd", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ToExpression", "[", "#2", "]"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"StringTrim", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<=\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"meta", "~", "StringReplace", "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<e-\>\"", "\[Rule]", "\"\<*^-\>\""}], ",", 
                RowBox[{"\"\<e+\>\"", "\[Rule]", "\"\<*^\>\""}]}], "}"}]}], 
             ",", "\"\<;\>\""}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importer", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"path", "=", "\"\<./moment-1.csv\>\""}], ","}], "*)"}], 
     RowBox[{"stride", "=", "7"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
            RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "2"}]}], "]"}], "//", 
          "Transpose"}]}], ",", "n", ",", "nV", ",", "nvv", ",", "meta"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"data", ",", "stride"}], "]"}], "//", "Transpose"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"data", "//", "Rest"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nV", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nvv", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", "\[Rule]", "n"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<nV\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "nV"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<nvv\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "nvv"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"moment", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"paths", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<moment-*.csv\>\"", ",", "\"\<.\>\""}], "]"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"path", ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"s", "=", 
                RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"StringCases", "[", 
               RowBox[{"s", ",", 
                RowBox[{
                 RowBox[{"\"\<-\>\"", "~~", 
                  RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                 "\[RuleDelayed]", 
                 RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         "]"}]}], ",", 
       RowBox[{"arrayKeys", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "\"\<n\>\"", "}"}], ",", 
          RowBox[{"StringJoin", "@@@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "@@@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nvv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importer", "[", "paths", "]"}], "]"}], ",", "Identity"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Ns\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Ns\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Set", "[", 
           RowBox[{
            RowBox[{"assoc", "[", "#", "]"}], ",", 
            RowBox[{"Thread", "[", 
             RowBox[{"assoc", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         "arrayKeys"}], ";", "\[IndentingNewLine]", "assoc"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "moment"}]], "Input"],

Cell[BoxData[
 RowBox[{"Union", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Mean", ",", 
       RowBox[{"moment", "[", "\"\<n\>\"", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "-", "1"}], ")"}]}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Particle", "Section"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importer", "[", 
   RowBox[{
    RowBox[{"spid_Integer", "?", "Positive"}], ",", "stepCount_Integer"}], 
   "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"path", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<.\>\"", ",", 
         RowBox[{"\"\<particle-sp_\>\"", "<>", 
          RowBox[{"ToString", "[", "spid", "]"}], "<>", "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", "stepCount", "]"}], "<>", 
          "\"\<.csv\>\""}]}], "}"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
          RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<v1\>\"", ",", "\"\<v2\>\"", ",", "\"\<v3\>\"", ",", 
            "\"\<x\>\""}], "}"}], ",", 
          RowBox[{"Transpose", "[", "data", "]"}]}], "]"}], "]"}], "//", 
       "Association"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ptls", "=", 
     RowBox[{"importer", "[", 
      RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"ptls", "[", "\"\<v1\>\"", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.5"}], ",", "3.5", ",", ".1"}], "}"}], ",", 
       "\"\<PDF\>\""}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"x", "^", "2"}]}], "]"}], "/", 
        SqrtBox["\[Pi]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ptls", "=", 
     RowBox[{"importer", "[", 
      RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ptls", "[", "\"\<v3\>\"", "]"}], "/", 
        SqrtBox["3"]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.5"}], ",", "3.5", ",", ".1"}], "}"}], ",", 
       "\"\<PDF\>\""}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"x", "^", "2"}]}], "]"}], "/", 
        SqrtBox["\[Pi]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]]
},
WindowSize->{1220, 1085},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 67, 1, 28, "Input"],
Cell[628, 23, 89, 1, 28, "Input"],
Cell[CellGroupData[{
Cell[742, 28, 25, 0, 64, "Section"],
Cell[770, 30, 2869, 71, 233, "Input"],
Cell[3642, 103, 64, 1, 28, "Input"],
Cell[3709, 106, 4057, 98, 335, "Input"],
Cell[7769, 206, 2697, 68, 352, "Input"],
Cell[10469, 276, 2816, 72, 284, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[13322, 353, 24, 0, 50, "Section"],
Cell[13349, 355, 1714, 43, 182, "Input"],
Cell[15066, 400, 2167, 54, 216, "Input"],
Cell[17236, 456, 1940, 48, 216, "Input"],
Cell[19179, 506, 63, 1, 28, "Input"],
Cell[19245, 509, 4479, 115, 505, "Input"],
Cell[23727, 626, 8422, 218, 590, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32186, 849, 25, 0, 64, "Section"],
Cell[32214, 851, 1714, 43, 182, "Input"],
Cell[33931, 896, 2755, 68, 267, "Input"],
Cell[36689, 966, 3120, 79, 250, "Input"],
Cell[39812, 1047, 64, 1, 28, "Input"],
Cell[39879, 1050, 276, 8, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[40192, 1063, 27, 0, 50, "Section"],
Cell[40222, 1065, 1382, 37, 131, "Input"],
Cell[41607, 1104, 909, 26, 168, "Input"],
Cell[42519, 1132, 956, 28, 180, "Input"]
}, Closed]]
}
]
*)

