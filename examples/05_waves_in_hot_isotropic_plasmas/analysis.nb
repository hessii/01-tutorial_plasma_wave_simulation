(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    117324,       2963]
NotebookOptionsPosition[    112309,       2888]
NotebookOutlinePosition[    112650,       2903]
CellTagsIndexPosition[    112607,       2900]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellLabel->
  "In[1164]:=",ExpressionUUID->"6b3b9c34-f330-4460-8d60-2807c4d0ace9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figdir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<.\>\"", ",", "\"\<figures\>\""}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[1166]:=",ExpressionUUID->"a6a13c5d-4baa-4bb4-88a5-9292453a6135"],

Cell[CellGroupData[{

Cell["Loader", "Subsection",ExpressionUUID->"e128867d-f81c-4723-a5f3-00f9a32a5b13"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "readMetadata", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readMetadata", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./moment-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fd", ",", "meta"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fd", "=", 
        RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"meta", "=", 
        RowBox[{"ReadLine", "[", "fd", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "fd", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ToExpression", "[", "#2", "]"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"StringTrim", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<=\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"meta", "~", "StringReplace", "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<e-\>\"", "\[Rule]", "\"\<*^-\>\""}], ",", 
                RowBox[{"\"\<e+\>\"", "\[Rule]", "\"\<*^\>\""}]}], "}"}]}], 
             ",", "\"\<;\>\""}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[1167]:=",ExpressionUUID->"d78cce98-3a82-4785-85db-8be2519bd616"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importField", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importField", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./field-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
            RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "2"}]}], "]"}], "//", 
          "Transpose"}]}], ",", "dE", ",", "dB", ",", "meta"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dB", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<dB\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "dB"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<dE\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "dE"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[1169]:=",ExpressionUUID->"832b9a46-ac29-42bb-9d5f-ba56a5964cbf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importMoment", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importMoment", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NentryPerSpecies", "=", "7"}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"path", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<../tmp/smoothing_effect\>\"", ",", "identifier", ",", 
           "\"\<data\>\"", ",", "\"\<moment-20.csv\>\""}], "}"}], "]"}]}]}], 
      "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
            RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "2"}]}], "]"}], "//", 
          "Transpose"}]}], ",", "n", ",", "nV1", ",", "nV2", ",", "nV3", ",", 
        "nv1v1", ",", "nv2v2", ",", "nv3v3", ",", "meta"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nV1", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nV2", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nV3", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nv1v1", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"5", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nv2v2", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"6", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nv3v3", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"7", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"\"\<sp\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}], "<>", "\"\<n\>\""}], 
               ",", "#"}], "]"}], "&"}], ",", "n"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"\"\<sp\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "Last"}], "]"}], "<>", "\"\<nV\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}]}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"nV1", ",", "nV2", ",", "nV3"}], "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"\"\<sp\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "Last"}], "]"}], "<>", "\"\<nv\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}], "<>", "\"\<v\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}]}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"nv1v1", ",", "nv2v2", ",", "nv3v3"}], "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[1171]:=",ExpressionUUID->"984258eb-365b-4048-ab10-6220b1896c2a"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importParticles", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importParticles", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<./data\>\"", ",", "\"\<particle-sp_1-1.csv\>\""}], 
         "}"}], "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
           RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}]}], ",", 
        "meta", ",", "keys"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"keys", "=", 
        RowBox[{"data", "//", "First"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{
         RowBox[{"data", "//", "Rest"}], "//", "Transpose"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"keys", ",", "data"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellLabel->
  "In[1173]:=",ExpressionUUID->"9ed86c53-5481-4662-b095-0d009e616ab7"]
}, Closed]],

Cell[CellGroupData[{

Cell["1. Longitudinal Wave Dispersion", "Section",ExpressionUUID->"d17bdbd7-c785-49bc-817d-0ecd77cc51f2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "findRootMuller", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"findRootMuller", "::", "conv"}], "=", 
   "\"\<Not converged after `1` iterations.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "findRootMuller", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"StepMonitor", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Null", "&"}], ")"}]}], ",", 
     RowBox[{"MaxIterations", "\[Rule]", "20"}], ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "5"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findRootMuller", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"init_", "?", "NumberQ"}], ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"findRootMuller", "[", 
   RowBox[{"f", ",", 
    RowBox[{"init", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"1*^-4", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", "3"}], "]"}]}]}], ")"}]}], 
    ",", "opts"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findRootMuller", "[", 
   RowBox[{"f_", ",", 
    RowBox[{
     RowBox[{"init", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "NumberQ"}], "}"}]}], "/;", 
     RowBox[{
      RowBox[{"Length", "[", "init", "]"}], "\[Equal]", "3"}]}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reltol", "=", 
       RowBox[{"Power", "[", 
        RowBox[{"10", ",", 
         RowBox[{"-", 
          RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"maxIt", "=", 
       RowBox[{"OptionValue", "[", "MaxIterations", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"stepMonitor", "=", 
       RowBox[{"OptionValue", "[", "StepMonitor", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "x2", ",", "x3", ",", "f1", ",", "f2", ",", "f3", ",", "w", 
        ",", "u", ",", "DD", ",", "\[CapitalDelta]", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "=", 
        RowBox[{
         RowBox[{"N", "[", "init", "]"}], "+", 
         RowBox[{"0.", "I"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"f1", ",", "f2", ",", "f3"}], "}"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", "\n", 
        RowBox[{"(*", 
         RowBox[{"initial", " ", "setup"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"{", 
               RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"i", "=", "0"}]}], ")"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{"stopping", " ", "criteria"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "\[CapitalDelta]", "]"}], ">", 
            RowBox[{"reltol", "*", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"{", 
                RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "]"}], "]"}]}]}],
            "&&", 
           RowBox[{"i", "<", "maxIt"}]}], ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"increment", " ", "loop", " ", "count"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"++", "i"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{"loop", " ", "main", " ", "body"}], "*)"}], "\n", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"w", "=", 
             RowBox[{
              FractionBox[
               RowBox[{"f3", "-", "f2"}], 
               RowBox[{"x3", "-", "x2"}]], "+", 
              FractionBox[
               RowBox[{"f3", "-", "f1"}], 
               RowBox[{"x3", "-", "x1"}]], "-", 
              FractionBox[
               RowBox[{"f2", "-", "f1"}], 
               RowBox[{"x2", "-", "x1"}]]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"u", "=", 
             RowBox[{
              FractionBox[
               RowBox[{"f1", "-", "f2"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x3"}], ")"}]}]], "-", 
              FractionBox[
               RowBox[{"f2", "-", "f3"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x3"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"x2", "-", "x3"}], ")"}]}]]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DD", "=", 
             RowBox[{"w", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"+", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"w", "^", "2"}], "-", 
                 RowBox[{"4", "u", " ", "f3"}]}], "]"}]}]}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"two", "-", 
              RowBox[{"element", " ", "array"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"DD", "=", 
             RowBox[{"If", "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Greater", "@@", 
                 RowBox[{"Abs", "[", "DD", "]"}]}], ",", 
                RowBox[{"Sequence", "@@", "DD"}]}], "}"}]}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"choose", " ", "the", " ", "greater", " ", "one"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]", "=", 
             RowBox[{"2", 
              RowBox[{"f3", "/", "DD"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "swap", " ", "out", " ", "variables", " ", "for", " ", "next", 
              " ", "iteration"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"x1", "=", "x2"}], ";", 
            RowBox[{"f1", "=", "f2"}], ";", "\[IndentingNewLine]", 
            RowBox[{"x2", "=", "x3"}], ";", 
            RowBox[{"f2", "=", "f3"}], ";", "\[IndentingNewLine]", 
            RowBox[{"x3", "-=", "\[CapitalDelta]"}], ";", 
            RowBox[{"f3", "=", 
             RowBox[{"f", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"stepMonitor", "[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "x3"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[GreaterEqual]", "maxIt"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"findRootMuller", "::", "conv"}], ",", "i"}], "]"}], ";", 
          
          RowBox[{"Throw", "[", "x3", "]"}]}], ",", "x3"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\
ExpressionUUID->"be325c22-c25c-4916-9965-29893068fcd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"k\[Omega]", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", "1"}], ",", 
       RowBox[{"\[Omega]pe", "=", "1"}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"Power", "[", 
         RowBox[{"10", ",", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"Log10", "[", "5", "]"}], ",", ".01"}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"\[Omega]0", "=", 
        RowBox[{"1.", "+", 
         RowBox[{"0.", "I"}]}]}], ",", 
       RowBox[{"Z", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"z", ",", 
          RowBox[{"I", 
           SqrtBox["\[Pi]"], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"z", "^", "2."}]}], "]"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "z"}], "]"}]}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Zp", ",", "\[Omega]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Zp", "=", 
         RowBox[{"Function", "[", 
          RowBox[{"z", ",", 
           RowBox[{
            RowBox[{"-", "2."}], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"z", " ", 
               RowBox[{"Z", "[", "z", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"{", "Listable", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"FoldList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"findRootMuller", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]", ",", 
                 RowBox[{"Module", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"tmp", "=", 
                    RowBox[{"Zp", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "/", "#2"}], "/", "\[Alpha]"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#2", " ", 
                    RowBox[{"\[Alpha]", "/", "\[Omega]pe"}]}], "-", 
                    SqrtBox["tmp"]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#2", " ", 
                    RowBox[{"\[Alpha]", "/", "\[Omega]pe"}]}], "+", 
                    SqrtBox["tmp"]}], ")"}]}]}], "\[IndentingNewLine]", 
                  "]"}]}], "]"}], ",", "#1", ",", 
               RowBox[{"AccuracyGoal", "\[Rule]", "5"}], 
               RowBox[{"(*", 
                RowBox[{",", 
                 RowBox[{"StepMonitor", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "&"}], ")"}]}]}], "*)"}],
                ",", 
               RowBox[{"MaxIterations", "\[Rule]", "10"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"\[Omega]0", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"1*^-4", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], "3"}], "]"}]}]}], ")"}]}], 
            ",", "k"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "\[Omega]"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[1061]:=",ExpressionUUID->"3bab77a4-cb28-47f5-ad5d-2ff37dfcb535"],

Cell[BoxData[
 RowBox[{"wd", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"demo", "=", "\"\<01_longitudinal_wave_dispersion\>\""}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<.\>\"", ",", "demo"}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[1042]:=",ExpressionUUID->"a361cb18-b53c-4c60-8f77-4f9d3824051e"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"c4f4b875-eac7-4c88-9404-d97f39ea73d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Last", ",", 
             RowBox[{"SplitBy", "[", 
              RowBox[{
               RowBox[{"SortBy", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                   ",", "\"\<CSV\>\"", ",", 
                   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                 ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}], "//", 
           "Transpose"}]}], ",", "step", ",", "time", ",", "dB2O2", ",", 
         "dE2O2", ",", "mv2O2", ",", "mU2O2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "mU2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<mU2O2\>\"", "->", "mU2O2"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[1043]:=",ExpressionUUID->"3f00439f-22e4-4b7f-833e-e7122facf749"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[1044]:=",ExpressionUUID->"2102d95f-d70a-4483-bf15-fc216f5680b1"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dE2O2", ",", "mv2O2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"time", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"IntervalMemberQ", "[", 
             RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}], "//", 
         "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}], "//", "Total"}], "//",
          "pos"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dE2O2", "//", "Transpose"}], "//", "First"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mv2O2", "//", "Transpose"}], "//", "First"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", "dE2O2", ")"}]}], ",", 
                RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[1045]:=",ExpressionUUID->"5ef9d974-2c9b-4013-b7b7-9519b632b669"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field", "Subsection",ExpressionUUID->"d2d3306c-a417-43a3-b4b1-79272a94e4ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<field-*.csv\>\"", ",", "wd"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"path", ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StringCases", "[", 
              RowBox[{"s", ",", 
               RowBox[{
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importField", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<pos\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "]"}], 
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "assoc"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[1046]:=",ExpressionUUID->"7b863926-1f44-401c-968c-a1b2afabbf31"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "field"}]], "Input",
 CellLabel->
  "In[1047]:=",ExpressionUUID->"4ed3c7cc-066c-4504-9eab-f7c28c58979d"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], ",", 
      RowBox[{"k\[Omega]", "=", "k\[Omega]"}], ",", 
      RowBox[{"kmax", "=", "5"}], ",", 
      RowBox[{"\[Omega]max", "=", "5"}], ",", 
      RowBox[{"decades", "=", "8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"cf", "=", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"#", ",", 
          RowBox[{"_", "?", "NumberQ"}], ",", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "#", 
           "]"}], ",", "_", ",", "Gray"}], "]"}], "&"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{"2.", "Pi"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$_Integer", "/;", 
               RowBox[{"$", "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"Length", "[", "x", "]"}], "/", "2"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{"$", "-", 
               RowBox[{"Length", "[", "x", "]"}]}]}], "}"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "k", ",", "pos\[Omega]", ",", "posk", ",", "dEx", ",",
         "win"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"fourier", " ", "domain"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "=", 
        RowBox[{"fun", "[", 
         RowBox[{"field", "[", "\"\<time\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"fun", "[", 
         RowBox[{"field", "[", "\"\<pos\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos\[Omega]", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"\[Omega]", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"0", "<", "$", "\[LessEqual]", "\[Omega]max"}]}]}], "]"}],
          "//", "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"posk", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"k", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"0", "<", "$", "\[LessEqual]", "kmax"}]}]}], "]"}], "//", 
         "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"\[Omega]", "//", "pos\[Omega]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"k", "//", "posk"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "FFT", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"field", "[", "\"\<dE1\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", 
        RowBox[{"HannWindow", "[", 
         RowBox[{".5", "-", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Length", "[", "dEx", "]"}], "-", "1"}]}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "dEx", "]"}], "-", "1"}], ")"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"posk", "/@", 
           RowBox[{"pos\[Omega]", "@", 
            RowBox[{"Fourier", "[", 
             RowBox[{"win", "*", "dEx"}], "]"}]}]}], "]"}], "^", "2"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{"Total", "[", 
               RowBox[{"Flatten", "[", "dEx", "]"}], "]"}], "]"}], "\[Equal]",
              "0"}], ",", 
            RowBox[{"dEx", "*", "Indeterminate"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"dEx", "/", 
              RowBox[{"Max", "[", "dEx", "]"}]}], "]"}]}], "]"}], "/", 
          "decades"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dEx", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
           RowBox[{"DataRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
              RowBox[{"\[Omega]", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", "cf"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Text", "[", 
               RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(1, x\)]\)\>\"", ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{".05", ",", ".95"}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}],
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"Re", "[", "k\[Omega]", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"White", ",", "Dashed"}], 
             RowBox[{"(*", 
              RowBox[{",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "*)"}], "]"}]}]}],
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRangePadding", "\[Rule]", 
          RowBox[{"Scaled", "[", ".01", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\\!\\(k\[VeryThinSpace]\[Alpha]/\!\(\*SubscriptBox[\(\[Omega]\
\), \(pe\)]\)\\)\>\"", ",", 
            "\"\<\\!\\(\[Omega]/\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\\)\
\>\""}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[1075]:=",ExpressionUUID->"be9d63e7-9206-4f17-8c48-c83ecc33fe95"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "wd", "]"}], "<>", 
       "\"\<-Ex_dispersion.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[1076]:=",ExpressionUUID->"f3d04ec3-6563-4525-89fb-4980b15410b1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Two-Stream Instability", "Section",ExpressionUUID->"a49cfbcd-1345-45bc-a353-15faed1a68e3"],

Cell[BoxData[
 RowBox[{"wd", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"demo", "=", "\"\<03_two_stream_instability\>\""}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<.\>\"", ",", "demo"}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[736]:=",ExpressionUUID->"d26ef1ff-50ed-4464-aa22-6c1e1c17ab66"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"83125ca6-ce33-438f-8af7-0792b1533a0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Last", ",", 
             RowBox[{"SplitBy", "[", 
              RowBox[{
               RowBox[{"SortBy", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                   ",", "\"\<CSV\>\"", ",", 
                   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                 ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}], "//", 
           "Transpose"}]}], ",", "step", ",", "time", ",", "dB2O2", ",", 
         "dE2O2", ",", "mv2O2", ",", "mU2O2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "mU2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<mU2O2\>\"", "->", "mU2O2"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[740]:=",ExpressionUUID->"0a3b8942-02d9-4e97-b7a4-fde7759b5922"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[741]:=",ExpressionUUID->"7cb0b11d-5057-4184-96b5-71e03da3d996"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}], ",", 
      RowBox[{"w", "=", "100"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dE2O2", ",", "mv2O2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"time", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"IntervalMemberQ", "[", 
             RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}], "//", 
         "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}], "//", "Total"}], "//",
          "pos"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"time", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"dE2O2", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"mv2O2", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dE2O2", "//", "Transpose"}], "//", "First"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mv2O2", "//", "Transpose"}], "//", "First"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", "dE2O2", ")"}]}], ",", 
                RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[754]:=",ExpressionUUID->"5ade4126-f58d-46af-80b6-4477a76c1b24"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"w", "=", "100"}], ",", 
      RowBox[{"fitspan", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"50", ",", "300"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "dE2O2", ",", "mv2O2", ",", "pos", ",", "linfit", ",", 
        "approx\[Gamma]", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"time", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"dE2O2", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"mv2O2", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"fitspan", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"linfit", "=", 
        RowBox[{"LeastSquares", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Extract", "[", 
              RowBox[{"time", ",", "pos"}], "]"}], ",", "1"}], "}"}], "]"}], 
          ",", 
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"dE2O2", "//", "Log"}], ",", "pos"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"approx\[Gamma]", "=", 
        RowBox[{".5", 
         RowBox[{"First", "[", "linfit", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"linfit", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ab", "=", "linfit"}], "}"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "1"}], "}"}], "ab"}], "//", "Total"}], "//",
              "Exp"}], ",", 
            RowBox[{"{", "Listable", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plots", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRangePadding", "\[Rule]", 
             RowBox[{"Thread", "[", 
              RowBox[{"Scaled", "[", 
               RowBox[{".01", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImagePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"46", ",", "Automatic"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "Automatic"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"time", ",", "dE2O2"}], "}"}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"2", 
                    RowBox[{"linfit", "[", "#", "]"}]}]}], "}"}], "&"}], "@", 
                 
                 RowBox[{"Extract", "[", 
                  RowBox[{"time", ",", "pos"}], "]"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Thread", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Black", ",", "Red"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Thickness", "[", "Medium", "]"}], ",", "Dashed"}],
                   "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"\"\<\[Gamma]=\>\"", "<>", 
                    RowBox[{"StringTrim", "[", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"approx\[Gamma]", ",", "2"}], "]"}], "]"}], "]"}],
                     "<>", "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)\>\""}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{".15", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Text", "[", 
                 RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(1, x\)]\)\>\"", ",", 
                  RowBox[{"Scaled", "[", 
                   RowBox[{"{", 
                    RowBox[{".97", ",", ".95"}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"time", ",", "dE2O2"}], "}"}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"time", ",", 
                  RowBox[{"mv2O2", "-", 
                   RowBox[{"First", "[", "mv2O2", "]"}]}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"time", ",", 
                  RowBox[{"dE2O2", "+", "mv2O2", "-", 
                   RowBox[{"First", "[", "mv2O2", "]"}]}]}], "}"}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Thread", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Red", ",", "Blue", ",", "Black"}], "}"}], ",", 
                 RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Dashing", "[", 
                    RowBox[{"{", "}"}], "]"}], ",", 
                   RowBox[{"Dashing", "[", 
                    RowBox[{"{", "}"}], "]"}], ",", "Dashed"}], "}"}]}], 
                "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(E\), \(1, x\)]\)\>\"", ",", 
                  "\"\<\\!\\(KE-\!\(\*SubscriptBox[\(KE\), \(0\)]\)\\)\>\"", 
                  ",", "\"\<Total\>\""}], "}"}], ",", "Right"}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(t\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)\\)\>\"", ",", "None"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Column", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[918]:=",ExpressionUUID->"a61e41dd-b178-4d5c-b7ea-883311931c0b"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "wd", "]"}], "<>", 
       "\"\<-energy_overview.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[919]:=",ExpressionUUID->"0f0eaa16-c21a-4f9a-9de2-496d5dc2c3d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Field", "Subsection",ExpressionUUID->"4ef98a16-4706-471c-ab3d-9c94ac395b4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<field-*.csv\>\"", ",", "wd"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"path", ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StringCases", "[", 
              RowBox[{"s", ",", 
               RowBox[{
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importField", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<pos\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "]"}], 
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "assoc"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[823]:=",ExpressionUUID->"50a9efda-d764-4a41-82a5-3c129608138d"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "field"}]], "Input",
 CellLabel->
  "In[824]:=",ExpressionUUID->"eebd8508-0302-44e4-af48-83820ff9683f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"field", "=", "field"}], ",", 
     RowBox[{"vd", "=", "2"}], ",", 
     RowBox[{"vdmax", "=", "2.6"}], ",", 
     RowBox[{"kmax", "=", "2"}], ",", 
     RowBox[{"\[Omega]max", "=", "2.1"}], ",", 
     RowBox[{"decades", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"cf", "=", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"#", ",", 
         RowBox[{"_", "?", "NumberQ"}], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "#", "]"}],
          ",", "_", ",", "Gray"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"fun", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"Divide", "[", 
          RowBox[{
           RowBox[{"2.", "Pi"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$_Integer", "/;", 
              RowBox[{"$", "\[GreaterEqual]", 
               RowBox[{
                RowBox[{"Length", "[", "x", "]"}], "/", "2"}]}]}], 
             "\[RuleDelayed]", 
             RowBox[{"$", "-", 
              RowBox[{"Length", "[", "x", "]"}]}]}], "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "k", ",", "pos\[Omega]", ",", "posk", ",", "dEx", ",", 
       "win"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"fourier", " ", "domain"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Omega]", "=", 
       RowBox[{"fun", "[", 
        RowBox[{"field", "[", "\"\<time\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"fun", "[", 
        RowBox[{"field", "[", "\"\<pos\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos\[Omega]", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"0", "<=", "$", "\[LessEqual]", "\[Omega]max"}]}]}], "]"}],
         "//", "Extract"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posk", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"k", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"0", "<=", "$", "\[LessEqual]", "kmax"}]}]}], "]"}], "//", 
        "Extract"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"\[Omega]", "//", "pos\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"k", "//", "posk"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "FFT", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dEx", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"field", "[", "\"\<dE1\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"win", "=", 
       RowBox[{"HannWindow", "[", 
        RowBox[{".5", "-", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "dEx", "]"}], "-", "1"}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "dEx", "]"}], "-", "1"}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dEx", "=", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"posk", "/@", 
          RowBox[{"pos\[Omega]", "@", 
           RowBox[{"Fourier", "[", 
            RowBox[{"win", "*", "dEx"}], "]"}]}]}], "]"}], "^", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dEx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Chop", "[", 
             RowBox[{"Total", "[", 
              RowBox[{"Flatten", "[", "dEx", "]"}], "]"}], "]"}], "\[Equal]", 
            "0"}], ",", 
           RowBox[{"dEx", "*", "Indeterminate"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"dEx", "/", 
             RowBox[{"Max", "[", "dEx", "]"}]}], "]"}]}], "]"}], "/", 
         "decades"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Labeled", "[", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dEx", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"k", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
               RowBox[{"\[Omega]", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "cf"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(E\), \(1, z\)]\)\>\"", ",", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{"{", 
                   RowBox[{".05", ",", ".95"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
              "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"White", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"2", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "/", "vd"}], ",", "1"}], "}"}]}]}], "}"}], 
              "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"ImageSize", "\[Rule]", "250"}]}], "\[IndentingNewLine]", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"TraditionalForm", "[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\\!\\(\[Omega]/\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\\)\>\
\"", ",", 
           "\"\<\\!\\(k\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Alpha]\), \
\(h\)]\)/\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\\)\>\""}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Left", ",", "Bottom"}], "}"}], ",", 
        RowBox[{"RotateLabel", "\[Rule]", "True"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",Exp\
ressionUUID->"f729345d-3842-46a1-8947-653324929e58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Exmax", "=", "7"}], ",", 
    RowBox[{"decades", "=", "10"}]}], "}"}], ";"}]], "Input",
 CellLabel->
  "In[911]:=",ExpressionUUID->"5fd20e9f-2cda-42c6-9c4e-d92c1b28776e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "drawSpec", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drawSpec", "[", "tlim_Interval", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"tlim", "=", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"50", ",", "500"}], "}"}], "]"}]}]}], "*)"}], ",", 
      RowBox[{"vd", "=", "2"}], ",", 
      RowBox[{"kmax", "=", "2"}], ",", 
      RowBox[{"\[Omega]max", "=", "2"}], ",", 
      RowBox[{"Exmax", "=", "Exmax"}], ",", 
      RowBox[{"decades", "=", "decades"}], ",", "\[IndentingNewLine]", 
      RowBox[{"cf", "=", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"#", ",", 
          RowBox[{"_", "?", "NumberQ"}], ",", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "#", 
           "]"}], ",", "_", ",", "Gray"}], "]"}], "&"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{"2.", "Pi"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$_Integer", "/;", 
               RowBox[{"$", "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"Length", "[", "x", "]"}], "/", "2"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{"$", "-", 
               RowBox[{"Length", "[", "x", "]"}]}]}], "}"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "post", ",", "\[Omega]", ",", "k", ",", "pos\[Omega]", ",", "posk", 
        ",", "dEx", ",", "win"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"post", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"field", "[", "\"\<time\>\"", "]"}], ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"IntervalMemberQ", "[", 
             RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}], "//", 
         "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"fourier", " ", "domain"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"fun", "[", 
         RowBox[{
          RowBox[{"field", "[", "\"\<time\>\"", "]"}], "//", "post"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"fun", "[", 
         RowBox[{"field", "[", "\"\<pos\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos\[Omega]", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"\[Omega]", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"0", "<=", "$", "\[LessEqual]", "\[Omega]max"}]}]}], 
          "]"}], "//", "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"posk", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"k", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"0", "<=", "$", "\[LessEqual]", "kmax"}]}]}], "]"}], "//",
          "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"\[Omega]", "//", "pos\[Omega]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"k", "//", "posk"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "FFT", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"field", "[", "\"\<dE1\>\"", "]"}], "//", "post"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"win", "=", 
        RowBox[{"HannWindow", "[", 
         RowBox[{".5", "-", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Length", "[", "dEx", "]"}], "-", "1"}]}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "dEx", "]"}], "-", "1"}], ")"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"posk", "/@", 
           RowBox[{"pos\[Omega]", "@", 
            RowBox[{"Fourier", "[", 
             RowBox[{"win", "*", "dEx"}], "]"}]}]}], "]"}], "^", "2"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Max", "[", "dEx", "]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"dEx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"dEx", "/", 
              RowBox[{"Max", "[", "dEx", "]"}]}], "]"}], "/", "decades"}], 
           "+", "1"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{"dEx", "/", "Exmax"}], "]"}], "/", "decades"}], "+", 
         "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dEx", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
           RowBox[{"DataRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
              RowBox[{"\[Omega]", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", "cf"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringJoin", "[", 
                   RowBox[{"\"\<\\!\\(\>\"", ",", 
                    RowBox[{"ToString", "[", "#1", "]"}], ",", 
                    "\"\<<t\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)<\>\"", ",", 
                    RowBox[{"ToString", "[", "#2", "]"}], ",", 
                    "\"\<\\)\>\""}], "]"}], "&"}], "@@", 
                 RowBox[{"MinMax", "[", "tlim", "]"}]}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{".96", ",", ".04"}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"White", ",", "Dashed", ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"2", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "/", "vd"}], ",", "1"}], "}"}]}]}], "}"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
             "\"\<\\!\\(\!\(\*SubscriptBox[\(v\), \(d\)]\)\\)\>\"", ",", 
              RowBox[{"1.8", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "/", "vd"}], ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "250"}]}], 
        RowBox[{"(*", 
         RowBox[{",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\!\\(k\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Alpha]\), \
\(h\)]\)/\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\\)\>\"", ",", 
             "\"\<\\!\\(\[Omega]/\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)\\)\>\""}], "}"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellLabel->
  "In[912]:=",ExpressionUUID->"622ec690-9424-4136-aee5-0c87377c1c30"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"figs", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"drawSpec", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "450"}], "}"}], "]"}], ",", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{"450", ",", "1000"}], "}"}], "]"}], ",", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{"1000", ",", "1500"}], "}"}], "]"}], ",", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{"1500", ",", "2000"}], "}"}], "]"}]}], "}"}], "]"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Legended", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Labeled", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{"figs", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"TraditionalForm", "[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\\!\\(k\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Alpha]\), \(h\)]\
\)/\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\\)\>\"", ",", 
           "\"\<\\!\\(\[Omega]/\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)\\)\>\""}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
        RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"BarLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Rainbow\>\"", ",", 
            RowBox[{
             RowBox[{"Log10", "[", "Exmax", "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "decades"}], ",", "0"}], "}"}]}]}], "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"10", ",", "200"}], "}"}]}], ",", 
          RowBox[{"LegendMargins", "\[Rule]", "0"}], ",", 
          RowBox[{
          "LegendLabel", "\[Rule]", 
           "\"\<\[LeftBracketingBar]\!\(\*SubscriptBox[\(E\), \
\(x\)]\)\!\(\*SuperscriptBox[\(\[RightBracketingBar]\), \(2\)]\)\>\""}]}], 
         "]"}], ",", "Right"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[968]:=",ExpressionUUID->"48de59c8-02a3-40a5-bb50-9328453985b0"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "wd", "]"}], "<>", 
       "\"\<-Ex_dispersion.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[969]:=",ExpressionUUID->"2bce377f-d281-42fb-b0a9-8af6dc3c8642"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], ",", 
      RowBox[{"kmax", "=", "2"}], ",", 
      RowBox[{"vd", "=", "2"}], ",", 
      RowBox[{"vphlim", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "7"}], "}"}]}], ",", 
      RowBox[{"decades", "=", "7"}], ",", 
      RowBox[{"w", "=", "10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"cf", "=", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"#", ",", 
          RowBox[{"_", "?", "NumberQ"}], ",", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "#", 
           "]"}], ",", "_", ",", "Gray"}], "]"}], "&"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{"2.", "Pi"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$_Integer", "/;", 
               RowBox[{"$", "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"Length", "[", "x", "]"}], "/", "2"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{"$", "-", 
               RowBox[{"Length", "[", "x", "]"}]}]}], "}"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "k", ",", "posk", ",", "dEx", ",", "max", ",", "yticks"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"field", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"fun", "[", 
         RowBox[{"field", "[", "\"\<pos\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posk", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"k", ",", 
           RowBox[{"$_Real", "/;", 
            RowBox[{"0", "<", "$", "\[LessEqual]", "kmax"}]}]}], "]"}], "//", 
         "Extract"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"k", "//", "posk"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{"field", "[", "\"\<dE1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"posk", ",", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Fourier", "/@", "dEx"}], "]"}], "^", "2"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{"Mean", "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{"dEx", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"Mean", "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{"t", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"max", "=", 
        RowBox[{"Max", "[", "dEx", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{"dEx", "/", "max"}], "]"}], "/", "decades"}], "+", "1"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"yticks", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", "1", ",", "2", ",", "3", ",", "10"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yticks", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "#"}], ",", "#"}], "}"}], "&"}], "/@", 
         "yticks"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"dEx", "\[Transpose]"}], "//", "Reverse"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", "cf"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{"1", "/", "1.5"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRangePadding", "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{"Scaled", "[", 
              RowBox[{".01", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1.5"}], "}"}]}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "yticks"}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "Automatic"}]}], "}"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Epilog", "->", 
            RowBox[{"{", 
             RowBox[{"Dashed", ",", "White", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MinMax", "[", "t", "]"}], ",", 
                  RowBox[{"1", "/", "vd"}]}], "}"}], "]"}], "]"}]}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<k\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Alpha]\), \
\(h\)]\)/\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\>\"", ",", 
                "\"\<\\!\\(\!\(\*SubscriptBox[\(v\), \
\(ph\)]\)/\!\(\*SubscriptBox[\(\[Alpha]\), \(h\)]\)\\)\>\""}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(t\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)\\)\>\"", ",", "None"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Rainbow\>\"", ",", 
               RowBox[{
                RowBox[{"Log10", "[", "max", "]"}], "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "decades"}], ",", "0"}], "}"}]}]}], "}"}], ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"10", ",", "150"}], "}"}]}], ",", 
             RowBox[{"LegendMargins", "\[Rule]", "0"}], ",", 
             RowBox[{
             "LegendLabel", "\[Rule]", 
              "\"\<\[LeftBracketingBar]\!\(\*SubscriptBox[\(E\), \(x\)]\)\!\(\
\*SuperscriptBox[\(\[RightBracketingBar]\), \(2\)]\)\>\""}]}], "]"}], ",", 
           "Right"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[965]:=",ExpressionUUID->"98b67f7f-6944-401c-acf2-837ff2f9b312"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "wd", "]"}], "<>", 
       "\"\<-Ex_kspec_evolution.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[967]:=",ExpressionUUID->"033f79d4-6f41-466b-91fe-94cd4594f28d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"6e553140-7a66-4632-b48b-e250a4b9679b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metaR", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spid", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"paths", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"paths", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"FileNames", "[", 
            RowBox[{
             RowBox[{"\"\<particle-sp_\>\"", "<>", 
              RowBox[{"ToString", "[", "spid", "]"}], "<>", 
              "\"\<-*.csv\>\""}], ",", "wd"}], "]"}], ",", 
           RowBox[{"Function", "[", 
            RowBox[{"path", ",", "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"s", "=", 
                 RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"StringCases", "[", 
                RowBox[{"s", ",", 
                 RowBox[{
                  RowBox[{"\"\<-\>\"", "~~", 
                   RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}],
                   "\[RuleDelayed]", 
                  RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"readMetadata", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<species\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<species\>\"", "]"}], "//", "First"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<files\>\"", "]"}], "=", "paths"}], ";", 
        "\[IndentingNewLine]", "assoc"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[970]:=",ExpressionUUID->"8286369a-e077-4ac5-84fc-320b7d8469c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metaL", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spid", "=", "2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"paths", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"paths", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"FileNames", "[", 
            RowBox[{
             RowBox[{"\"\<particle-sp_\>\"", "<>", 
              RowBox[{"ToString", "[", "spid", "]"}], "<>", 
              "\"\<-*.csv\>\""}], ",", "wd"}], "]"}], ",", 
           RowBox[{"Function", "[", 
            RowBox[{"path", ",", "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"s", "=", 
                 RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"StringCases", "[", 
                RowBox[{"s", ",", 
                 RowBox[{
                  RowBox[{"\"\<-\>\"", "~~", 
                   RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}],
                   "\[RuleDelayed]", 
                  RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"readMetadata", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<species\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<species\>\"", "]"}], "//", "First"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<files\>\"", "]"}], "=", "paths"}], ";", 
        "\[IndentingNewLine]", "assoc"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[971]:=",ExpressionUUID->"e61cb594-942e-41fb-8c88-f7294a45d048"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "metaL"}]], "Input",
 CellLabel->
  "In[972]:=",ExpressionUUID->"fa0c2c9b-76a8-4deb-940e-7f551a1f1454"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "calHist", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calHist", "[", "ptls__Association", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ptl", "=", "ptl1"}], ","}], "*)"}], 
     RowBox[{"vxspec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "5", ",", ".2"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w", ",", "vx", ",", "ptl", ",", "pos", ",", "f", ",", "df"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "=", 
        RowBox[{"Join", "@@", 
         RowBox[{"Through", "[", 
          RowBox[{
           RowBox[{"{", "ptls", "}"}], "[", "\"\<w\>\"", "]"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vx", "=", 
        RowBox[{"Join", "@@", 
         RowBox[{"Through", "[", 
          RowBox[{
           RowBox[{"{", "ptls", "}"}], "[", "\"\<v1\>\"", "]"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ptl", "=", 
        RowBox[{"First", "[", 
         RowBox[{"{", "ptls", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"bin", " ", "in", " ", "vx"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"pos", "=", 
        RowBox[{"Cases", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SplitBy", "[", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"vx", "-", 
                    RowBox[{"vxspec", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
                   RowBox[{"Last", "[", "vxspec", "]"}]}], "]"}], "+", "1"}], 
                ",", 
                RowBox[{"List", "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "vx", "]"}], "]"}]}]}], "}"}], "]"}],
              "]"}], ",", "First"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"l", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i_Integer", "?", "Positive"}], ",", 
                 RowBox[{"{", "_Integer", "}"}]}], "}"}], ".."}], "}"}]}], "/;", 
            RowBox[{"i", "<", 
             RowBox[{"Length", "[", 
              RowBox[{"Range", "@@", "vxspec"}], "]"}]}]}], "\[RuleDelayed]", 
           
           RowBox[{"Rule", "[", 
            RowBox[{"i", ",", 
             RowBox[{"Extract", "[", 
              RowBox[{"Last", "/@", "l"}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "hist", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"vx", "=", 
        RowBox[{"N", "@", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{
           RowBox[{"Range", "@@", "vxspec"}], ",", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "vx", "}"}]}], "]"}], ",", "pos"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"e_Extract", "\[RuleDelayed]", 
             RowBox[{"e", "[", "w", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"df", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Total", ",", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "vx", "}"}]}], "]"}], ",", "pos"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"e_Extract", "\[RuleDelayed]", 
             RowBox[{"e", "[", "w", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "/=", 
        RowBox[{
         RowBox[{"Length", "[", "w", "]"}], 
         RowBox[{"Last", "[", "vxspec", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"df", "/=", 
        RowBox[{
         RowBox[{"Length", "[", "w", "]"}], 
         RowBox[{"Last", "[", "vxspec", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<vx\>\"", "\[Rule]", "vx"}], ",", 
         RowBox[{"\"\<f\>\"", "\[Rule]", "f"}], ",", 
         RowBox[{"\"\<df\>\"", "\[Rule]", "df"}], ",", 
         RowBox[{"\"\<time\>\"", "\[Rule]", 
          RowBox[{"ptl", "[", "\"\<time\>\"", "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellLabel->
  "In[1006]:=",ExpressionUUID->"c49f243b-7a0f-48bf-86df-a2eb2209426c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hists", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"calHist", "[", 
       RowBox[{
        RowBox[{"importParticles", "[", "#1", "]"}], ",", 
        RowBox[{"importParticles", "[", "#2", "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Through", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"metaR", ",", "metaL"}], "}"}], "[", "\"\<files\>\"", "]"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[1008]:=",ExpressionUUID->"3cd3a083-6dd3-4dee-88d0-94280752859b"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", 
  RowBox[{"hists", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[1009]:=",ExpressionUUID->"8f273b20-bc08-43aa-bb2a-3fbbe6088774"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"hists", "=", 
       RowBox[{"hists", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"\[Alpha]h", "=", "1"}], ",", 
      RowBox[{"vd", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"clrs", ",", "plot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"clrs", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "Black", "}"}], ",", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "/@", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{"#", "&"}], ",", 
             RowBox[{"Length", "[", "hists", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", "=", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             FractionBox[".5", 
              SqrtBox["\[Pi]"]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"vx", "-", "vd"}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"\[Alpha]h", "^", "2"}]}], "]"}], "+", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"vx", "+", "vd"}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"\[Alpha]h", "^", "2"}]}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"vx", ",", 
              RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"First", "[", "clrs", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"#vx", ",", "#f"}], "}"}], "]"}], "&"}], "/@", 
             "hists"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Thread", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Rest", "[", "clrs", "]"}], ",", 
                RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}]}]}],
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"#vx", ",", "#f"}], "}"}], "]"}], "&"}], "@", 
             RowBox[{"hists", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Last", "[", "clrs", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\!\\(\!\(\*SubscriptBox[\(v\), \(x\)]\)/\!\(\*SubscriptBox[\
\(\[Alpha]\), \(h\)]\)\\)\>\"", ",", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(F\), \(h, x\)]\)\\)\>\""}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"LineLegend", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"clrs", ",", "1"}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"clrs", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
                  RowBox[{"Thickness", "[", "Small", "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"Take", "[", 
                RowBox[{"clrs", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringTrim", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "#time", "]"}], ",", 
                   "\"\<.\>\""}], "]"}], "&"}], "/@", "hists"}]}], "]"}]}], 
            "]"}], ",", "Right"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[1037]:=",ExpressionUUID->"9c568c53-9ef9-4225-b027-4e8c5464ddbf"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "wd", "]"}], "<>", 
       "\"\<-distribution_function.png\>\""}]}], "}"}], "]"}], ",", 
   "dynamic"}], "]"}]], "Input",
 CellLabel->
  "In[1038]:=",ExpressionUUID->"1c896040-b282-43d8-802f-464baadcce2d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1073, 906},
WindowMargins->{{Automatic, -1550}, {35, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 258, 5, 52, "Input",ExpressionUUID->"6b3b9c34-f330-4460-8d60-2807c4d0ace9"],
Cell[819, 27, 272, 8, 30, "Input",ExpressionUUID->"a6a13c5d-4baa-4bb4-88a5-9292453a6135"],
Cell[CellGroupData[{
Cell[1116, 39, 83, 0, 54, "Subsection",ExpressionUUID->"e128867d-f81c-4723-a5f3-00f9a32a5b13"],
Cell[1202, 41, 1798, 45, 220, "Input",ExpressionUUID->"d78cce98-3a82-4785-85db-8be2519bd616"],
Cell[3003, 88, 2257, 56, 262, "Input",ExpressionUUID->"832b9a46-ac29-42bb-9d5f-ba56a5964cbf"],
Cell[5263, 146, 4872, 122, 409, "Input",ExpressionUUID->"984258eb-365b-4048-ab10-6220b1896c2a"],
Cell[10138, 270, 1626, 42, 199, "Input",ExpressionUUID->"9ed86c53-5481-4662-b095-0d009e616ab7"]
}, Closed]],
Cell[CellGroupData[{
Cell[11801, 317, 105, 0, 53, "Section",ExpressionUUID->"d17bdbd7-c785-49bc-817d-0ecd77cc51f2"],
Cell[11909, 319, 7799, 202, 863, "Input",ExpressionUUID->"be325c22-c25c-4916-9965-29893068fcd9"],
Cell[19711, 523, 3873, 102, 309, "Input",ExpressionUUID->"3bab77a4-cb28-47f5-ad5d-2ff37dfcb535"],
Cell[23587, 627, 441, 12, 73, "Input",ExpressionUUID->"a361cb18-b53c-4c60-8f77-4f9d3824051e"],
Cell[CellGroupData[{
Cell[24053, 643, 83, 0, 54, "Subsection",ExpressionUUID->"c4f4b875-eac7-4c88-9404-d97f39ea73d2"],
Cell[24139, 645, 3394, 84, 325, "Input",ExpressionUUID->"3f00439f-22e4-4b7f-833e-e7122facf749"],
Cell[27536, 731, 148, 3, 30, "Input",ExpressionUUID->"2102d95f-d70a-4483-bf15-fc216f5680b1"],
Cell[27687, 736, 4417, 108, 430, "Input",ExpressionUUID->"5ef9d974-2c9b-4013-b7b7-9519b632b669"]
}, Closed]],
Cell[CellGroupData[{
Cell[32141, 849, 82, 0, 38, "Subsection",ExpressionUUID->"d2d3306c-a417-43a3-b4b1-79272a94e4ac"],
Cell[32226, 851, 2305, 57, 283, "Input",ExpressionUUID->"7b863926-1f44-401c-968c-a1b2afabbf31"],
Cell[34534, 910, 147, 3, 30, "Input",ExpressionUUID->"4ed3c7cc-066c-4504-9eab-f7c28c58979d"],
Cell[34684, 915, 7895, 193, 828, "Input",ExpressionUUID->"be9d63e7-9206-4f17-8c48-c83ecc33fe95"],
Cell[42582, 1110, 377, 11, 30, "Input",ExpressionUUID->"f3d04ec3-6563-4525-89fb-4980b15410b1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[43008, 1127, 99, 0, 53, "Section",ExpressionUUID->"a49cfbcd-1345-45bc-a353-15faed1a68e3"],
Cell[43110, 1129, 434, 12, 73, "Input",ExpressionUUID->"d26ef1ff-50ed-4464-aa22-6c1e1c17ab66"],
Cell[CellGroupData[{
Cell[43569, 1145, 83, 0, 54, "Subsection",ExpressionUUID->"83125ca6-ce33-438f-8af7-0792b1533a0a"],
Cell[43655, 1147, 3393, 84, 325, "Input",ExpressionUUID->"0a3b8942-02d9-4e97-b7a4-fde7759b5922"],
Cell[47051, 1233, 147, 3, 30, "Input",ExpressionUUID->"7cb0b11d-5057-4184-96b5-71e03da3d996"],
Cell[47201, 1238, 4883, 117, 493, "Input",ExpressionUUID->"5ade4126-f58d-46af-80b6-4477a76c1b24"],
Cell[52087, 1357, 9883, 233, 945, "Input",ExpressionUUID->"a61e41dd-b178-4d5c-b7ea-883311931c0b"],
Cell[61973, 1592, 378, 11, 30, "Input",ExpressionUUID->"0f0eaa16-c21a-4f9a-9de2-496d5dc2c3d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62388, 1608, 82, 0, 54, "Subsection",ExpressionUUID->"4ef98a16-4706-471c-ab3d-9c94ac395b4b"],
Cell[62473, 1610, 2304, 57, 283, "Input",ExpressionUUID->"50a9efda-d764-4a41-82a5-3c129608138d"],
Cell[64780, 1669, 146, 3, 30, "Input",ExpressionUUID->"eebd8508-0302-44e4-af48-83820ff9683f"],
Cell[64929, 1674, 8099, 204, 723, "Input",ExpressionUUID->"f729345d-3842-46a1-8947-653324929e58"],
Cell[73031, 1880, 235, 7, 30, "Input",ExpressionUUID->"5fd20e9f-2cda-42c6-9c4e-d92c1b28776e"],
Cell[73269, 1889, 9507, 235, 914, "Input",ExpressionUUID->"622ec690-9424-4136-aee5-0c87377c1c30"],
Cell[82779, 2126, 2575, 66, 236, "Input",ExpressionUUID->"48de59c8-02a3-40a5-bb50-9328453985b0"],
Cell[85357, 2194, 376, 11, 30, "Input",ExpressionUUID->"2bce377f-d281-42fb-b0a9-8af6dc3c8642"],
Cell[85736, 2207, 8416, 209, 809, "Input",ExpressionUUID->"98b67f7f-6944-401c-acf2-837ff2f9b312"],
Cell[94155, 2418, 381, 11, 30, "Input",ExpressionUUID->"033f79d4-6f41-466b-91fe-94cd4594f28d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94573, 2434, 85, 0, 54, "Subsection",ExpressionUUID->"6e553140-7a66-4632-b48b-e250a4b9679b"],
Cell[94661, 2436, 2625, 63, 325, "Input",ExpressionUUID->"8286369a-e077-4ac5-84fc-320b7d8469c0"],
Cell[97289, 2501, 2625, 63, 325, "Input",ExpressionUUID->"e61cb594-942e-41fb-8c88-f7294a45d048"],
Cell[99917, 2566, 146, 3, 30, "Input",ExpressionUUID->"fa0c2c9b-76a8-4deb-940e-7f551a1f1454"],
Cell[100066, 2571, 5180, 132, 430, "Input",ExpressionUUID->"c49f243b-7a0f-48bf-86df-a2eb2209426c"],
Cell[105249, 2705, 555, 16, 30, "Input",ExpressionUUID->"3cd3a083-6dd3-4dee-88d0-94280752859b"],
Cell[105807, 2723, 199, 5, 30, "Input",ExpressionUUID->"8f273b20-bc08-43aa-bb2a-3fbbe6088774"],
Cell[106009, 2730, 5883, 141, 722, "Input",ExpressionUUID->"9c568c53-9ef9-4225-b027-4e8c5464ddbf"],
Cell[111895, 2873, 386, 11, 30, "Input",ExpressionUUID->"1c896040-b282-43d8-802f-464baadcce2d"]
}, Open  ]]
}, Open  ]]
}
]
*)

