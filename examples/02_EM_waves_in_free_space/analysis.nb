(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     89613,       2268]
NotebookOptionsPosition[     85926,       2213]
NotebookOutlinePosition[     86265,       2228]
CellTagsIndexPosition[     86222,       2225]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellLabel->
  "In[814]:=",ExpressionUUID->"6b3b9c34-f330-4460-8d60-2807c4d0ace9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figdir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<.\>\"", ",", "\"\<figures\>\""}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[816]:=",ExpressionUUID->"a6a13c5d-4baa-4bb4-88a5-9292453a6135"],

Cell[CellGroupData[{

Cell["Field Loader", "Subsection",ExpressionUUID->"e128867d-f81c-4723-a5f3-00f9a32a5b13"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "readMetadata", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readMetadata", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./moment-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fd", ",", "meta"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fd", "=", 
        RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"meta", "=", 
        RowBox[{"ReadLine", "[", "fd", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "fd", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ToExpression", "[", "#2", "]"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"StringTrim", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<=\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"meta", "~", "StringReplace", "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<e-\>\"", "\[Rule]", "\"\<*^-\>\""}], ",", 
                RowBox[{"\"\<e+\>\"", "\[Rule]", "\"\<*^\>\""}]}], "}"}]}], 
             ",", "\"\<;\>\""}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[817]:=",ExpressionUUID->"d78cce98-3a82-4785-85db-8be2519bd616"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importField", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importField", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"path", "=", "\"\<./field-1.csv\>\""}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
            RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "2"}]}], "]"}], "//", 
          "Transpose"}]}], ",", "dE", ",", "dB", ",", "meta"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dB", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dE", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<dB\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "dB"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"StringJoin", "@@@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<dE\>\"", ",", 
                 RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
               "]"}]}], ",", "dE"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[819]:=",ExpressionUUID->"832b9a46-ac29-42bb-9d5f-ba56a5964cbf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "importMoment", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importMoment", "[", 
   RowBox[{"path_String", "?", "FileExistsQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NentryPerSpecies", "=", "7"}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"path", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<../tmp/smoothing_effect\>\"", ",", "identifier", ",", 
           "\"\<data\>\"", ",", "\"\<moment-20.csv\>\""}], "}"}], "]"}]}]}], 
      "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", "\"\<CSV\>\"", ",", 
            RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "2"}]}], "]"}], "//", 
          "Transpose"}]}], ",", "n", ",", "nV1", ",", "nV2", ",", "nV3", ",", 
        "nv1v1", ",", "nv2v2", ",", "nv3v3", ",", "meta"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nV1", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nV2", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nV3", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nv1v1", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"5", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nv2v2", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"6", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nv3v3", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"7", ";;", 
           RowBox[{"-", "1"}], ";;", "NentryPerSpecies"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"meta", "=", 
        RowBox[{"readMetadata", "[", "path", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"meta", ",", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"\"\<sp\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}], "<>", "\"\<n\>\""}], 
               ",", "#"}], "]"}], "&"}], ",", "n"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"\"\<sp\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "Last"}], "]"}], "<>", "\"\<nV\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}]}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"nV1", ",", "nV2", ",", "nV3"}], "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"\"\<sp\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "Last"}], "]"}], "<>", "\"\<nv\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}], "<>", "\"\<v\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#2", "//", "First"}], "]"}]}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"nv1v1", ",", "nv2v2", ",", "nv3v3"}], "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[821]:=",ExpressionUUID->"984258eb-365b-4048-ab10-6220b1896c2a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Prob 14.2", "Section",ExpressionUUID->"408cddcc-c4f7-4e7f-8f25-3f2b402028b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<.\>\"", ",", "\"\<01_prob_14_2\>\""}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[823]:=",ExpressionUUID->"1d807801-045b-46c9-8864-a72423a29aea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<field-*.csv\>\"", ",", "wd"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"path", ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StringCases", "[", 
              RowBox[{"s", ",", 
               RowBox[{
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importField", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"E", " ", "field", " ", "coordinates"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<x1\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "]"}], 
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<t1\>\"", "]"}], "=", 
         RowBox[{"assoc", "[", "\"\<time\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"B", " ", "field", " ", "grid", " ", "coordinates"}], ";", 
          " ", 
          RowBox[{"lagging", " ", "behind", " ", "by", " ", "half"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<x2\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<x1\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "/", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<t2\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<t1\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Subtract", "@@", 
              RowBox[{
               RowBox[{"assoc", "[", "\"\<time\>\"", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
           "2"}]}]}], ";", "\[IndentingNewLine]", "assoc"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[824]:=",ExpressionUUID->"a30634d5-bc78-43a7-8120-ee203a4937db"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "field"}]], "Input",
 CellLabel->
  "In[825]:=",ExpressionUUID->"79c5add7-dce5-47c8-bdd1-c85bbb07346c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dynamic", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"field", "=", "field"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "t1", ",", "t2", ",", "dBz", ",", "dEy", ",", "x1", ",", "x2", ",", 
         "plots"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t1", "=", 
         RowBox[{
          RowBox[{"field", "[", "\"\<t1\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t2", "=", 
         RowBox[{
          RowBox[{"field", "[", "\"\<t2\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dEy", "=", 
         RowBox[{
          RowBox[{"field", "[", "\"\<dE2\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"-", "1"}], ";;", "2"}], ",", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "1"}], ";;", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dBz", "=", 
         RowBox[{
          RowBox[{"field", "[", "\"\<dB3\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"-", "1"}], ";;", "2"}], ",", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "1"}], ";;", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x1", "=", 
         RowBox[{
          RowBox[{"field", "[", "\"\<x1\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x2", "=", 
         RowBox[{
          RowBox[{"field", "[", "\"\<x2\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Apply", "[", 
                    RowBox[{"Join", ",", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"$1", ",", "$2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"$1", ",", "$1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"$2", ",", "\"\<\>\""}], "}"}]}], "}"}]}], "]"}], 
                    "@@@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}]}], "]"}], ",", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "Null"}], "}"}], "]"}]}], "}"}], "&"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"Max", "[", "t1", "]"}], ",", 
                    RowBox[{"2", "Pi"}]}], "]"}], ",", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"Max", "[", "x1", "]"}], ",", 
                    RowBox[{"2", "Pi"}]}], "]"}]}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(x\[VeryThinSpace]k\\)\>\"", ",", 
                "\"\<\\!\\(t\[VeryThinSpace]\[Omega]\\)\>\""}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "\[Rule]", 
              RowBox[{"Scaled", "[", ".02", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImagePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "1"}], "}"}]}], "}"}]}]}], 
            "\[IndentingNewLine]", "]"}], "&"}], "/@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dEy", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
              RowBox[{"DataRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x1", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                 RowBox[{"t1", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\\!\\(\!\(\*SubscriptBox[\(E\), \(y\)]\)(x,t)\\)\>\"", 
                 ",", "13"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dBz", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
              RowBox[{"DataRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x2", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                 RowBox[{"t2", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\\!\\(\!\(\*SubscriptBox[\(B\), \(z\)]\)(x,t)\\)\>\"", 
                 ",", "13"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Spacer", "[", "5", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[502]:=",ExpressionUUID->"4e2a2444-093f-425e-8852-131b204fca99"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-em_wave_fronts.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[402]:=",ExpressionUUID->"560b4260-daf5-4cdc-8346-5260de6b8265"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], ",", 
      RowBox[{"c", "=", "1"}], ",", 
      RowBox[{"k", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", "t2", ",", "x1", ",", "x2", ",", "dBz", ",", "dEy", ",", 
        "t0", ",", "x0", ",", "Sx", ",", "meanSx", ",", "meant0", ",", 
        "\[Omega]", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{"field", "[", "\"\<t1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"field", "[", "\"\<t2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"field", "[", "\"\<x1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x2", "=", 
        RowBox[{"field", "[", "\"\<x2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{"field", "[", "\"\<dE2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{"field", "[", "\"\<dB3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "interpolation", " ", "onto", " ", "the", " ", "same", " ", 
         "coordinates"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x0", "=", 
        RowBox[{"Mean", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"dEy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x2", ",", 
             RowBox[{"dBz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t0", "=", 
        RowBox[{"t1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t1", ",", "dEy"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "dBz"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "Poynting", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Sx", "=", 
        RowBox[{"c", "*", "dEy", "*", "dBz"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"k", " ", "c"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{
           RowBox[{"Pi", "/", "\[Omega]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t0", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"t0", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "//", "Round"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"meant0", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"t0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meanSx", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"Sx", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "Sx"}], "}"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"meant0", ",", "meanSx"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", "Medium", "]"}], ",", "Dotted"}], 
                "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotLabels", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Text", "/@", 
              RowBox[{"Thread", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(S\), \(x\)]\)\>\"", ",", 
                   "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(S\), \(x\)]\)\
\[RightAngleBracket]\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Gray", ",", "Red"}], "}"}]}], "]"}], "]"}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Join", ",", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"$1", ",", "$2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"$1", ",", "$1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"$2", ",", "\"\<\>\""}], "}"}]}], "}"}]}], "]"}], 
               "@@@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Max", "[", "t0", "]"}], ",", "Pi"}], "]"}], ",", 
                 "2"}], "]"}]}]}], "]"}], ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\\!\\(t\[VeryThinSpace]\[Omega]\\)\>\"", ",", "None"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[839]:=",ExpressionUUID->"26f5a75f-e38d-41f5-ad29-cd22d4ba8b22"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-poynting_vector.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[840]:=",ExpressionUUID->"1536e61f-bf60-4453-a682-655617b74852"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], ",", 
      RowBox[{"c", "=", "1"}], ",", 
      RowBox[{"k", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", "t2", ",", "x1", ",", "x2", ",", "dBz", ",", "dEy", ",", 
        "t0", ",", "x0", ",", "EM", ",", "meanEM", ",", "meant0", ",", 
        "\[Omega]", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{"field", "[", "\"\<t1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"field", "[", "\"\<t2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"field", "[", "\"\<x1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x2", "=", 
        RowBox[{"field", "[", "\"\<x2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{"field", "[", "\"\<dE2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{"field", "[", "\"\<dB3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "interpolation", " ", "onto", " ", "the", " ", "same", " ", 
         "coordinates"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x0", "=", 
        RowBox[{"Mean", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"dEy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x2", ",", 
             RowBox[{"dBz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t0", "=", 
        RowBox[{"t1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t1", ",", "dEy"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "dBz"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "Poynting", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EM", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dEy", "^", "2"}], "+", 
           RowBox[{"dBz", "^", "2"}]}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"k", " ", "c"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{
           RowBox[{"Pi", "/", "\[Omega]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t0", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"t0", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "//", "Round"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"meant0", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"t0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meanEM", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"EM", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "EM"}], "}"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"meant0", ",", "meanEM"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", "Medium", "]"}], ",", "Dotted"}], 
                "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotLabels", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Text", "/@", 
              RowBox[{"Thread", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<W\>\"", ",", 
                   "\"\<\[LeftAngleBracket]W\[RightAngleBracket]\>\""}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Gray", ",", "Red"}], "}"}]}], "]"}], "]"}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Join", ",", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"$1", ",", "$2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"$1", ",", "$1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"$2", ",", "\"\<\>\""}], "}"}]}], "}"}]}], "]"}], 
               "@@@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Max", "[", "t0", "]"}], ",", "Pi"}], "]"}], ",", 
                 "2"}], "]"}]}]}], "]"}], ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\\!\\(t\[VeryThinSpace]\[Omega]\\)\>\"", ",", "None"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[837]:=",ExpressionUUID->"6e45cc95-24d0-469c-b8e8-d0093c10c97d"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-em_energy.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[838]:=",ExpressionUUID->"9fbba661-1d12-49dd-b41c-0f80c40a2e7d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Prob 14.4 & 14.6", "Section",ExpressionUUID->"960d2089-6b68-4135-a2e5-0a45c397a349"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<.\>\"", ",", "\"\<02_prob_14_4\>\""}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[841]:=",ExpressionUUID->"47a811b6-f9ee-471d-9699-4022b0bfc356"],

Cell[BoxData[
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<field-*.csv\>\"", ",", "wd"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"path", ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StringCases", "[", 
              RowBox[{"s", ",", 
               RowBox[{
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importField", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"E", " ", "field", " ", "coordinates"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<x1\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "]"}], 
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<t1\>\"", "]"}], "=", 
         RowBox[{"assoc", "[", "\"\<time\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"B", " ", "field", " ", "grid", " ", "coordinates"}], ";", 
          " ", 
          RowBox[{"lagging", " ", "behind", " ", "by", " ", "half"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<x2\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<x1\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "/", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<t2\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<t1\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Subtract", "@@", 
              RowBox[{
               RowBox[{"assoc", "[", "\"\<time\>\"", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
           "2"}]}]}], ";", "\[IndentingNewLine]", "assoc"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[842]:=",ExpressionUUID->"75e361ae-7b0d-4d05-897a-75e20fc725d9"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "field"}]], "Input",
 CellLabel->
  "In[843]:=",ExpressionUUID->"0a552b45-bdaf-46ee-a733-e033e7a129ae"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], ",", 
      RowBox[{"c", "=", "1"}], ",", 
      RowBox[{"k", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", "t2", ",", "x1", ",", "x2", ",", "dBz", ",", "dBy", ",", 
        "dEy", ",", "dEz", ",", "t0", ",", "x0", ",", "Sx", ",", "meanSx", 
        ",", "meant0", ",", "\[Omega]", ",", "n"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{"field", "[", "\"\<t1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"field", "[", "\"\<t2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"field", "[", "\"\<x1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x2", "=", 
        RowBox[{"field", "[", "\"\<x2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{"field", "[", "\"\<dE2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEz", "=", 
        RowBox[{"field", "[", "\"\<dE3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{"field", "[", "\"\<dB3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBy", "=", 
        RowBox[{"field", "[", "\"\<dB2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "interpolation", " ", "onto", " ", "the", " ", "same", " ", 
         "coordinates"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x0", "=", 
        RowBox[{"Mean", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"dEy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"dEz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x2", ",", 
             RowBox[{"dBy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x2", ",", 
             RowBox[{"dBz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t0", "=", 
        RowBox[{"t1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t1", ",", "dEy"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t1", ",", "dEz"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "dBy"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "dBz"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "Poynting", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Sx", "=", 
        RowBox[{"c", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dEy", "*", "dBz"}], "-", 
           RowBox[{"dEz", "*", "dBy"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"k", " ", "c"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{
           RowBox[{"Pi", "/", "\[Omega]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t0", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"t0", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "//", "Round"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"meant0", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"t0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meanSx", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"Sx", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "Sx"}], "}"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"meant0", ",", "meanSx"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", "Medium", "]"}], ",", "Dotted"}], 
                "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotLabels", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Text", "/@", 
              RowBox[{"Thread", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(S\), \(x\)]\)\>\"", ",", 
                   "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(S\), \(x\)]\)\
\[RightAngleBracket]\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Gray", ",", "Red"}], "}"}]}], "]"}], "]"}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Max", "[", "t0", "]"}], ",", 
              RowBox[{"2", "Pi"}]}], "]"}], ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\\!\\(t\[VeryThinSpace]\[Omega]\\)\>\"", ",", "None"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[846]:=",ExpressionUUID->"6466da60-931e-4aa0-999c-605e2d54736e"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-poynting_vector.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[847]:=",ExpressionUUID->"1ac27bb3-b142-4f1f-83fc-73d619927664"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"field", "=", "field"}], ",", 
      RowBox[{"c", "=", "1"}], ",", 
      RowBox[{"k", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", "t2", ",", "x1", ",", "x2", ",", "dBz", ",", "dBy", ",", 
        "dEy", ",", "dEz", ",", "t0", ",", "x0", ",", "EM", ",", "meanEM", 
        ",", "meant0", ",", "\[Omega]", ",", "n"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{"field", "[", "\"\<t1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"field", "[", "\"\<t2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"field", "[", "\"\<x1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x2", "=", 
        RowBox[{"field", "[", "\"\<x2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{"field", "[", "\"\<dE2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEz", "=", 
        RowBox[{"field", "[", "\"\<dE3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{"field", "[", "\"\<dB3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBy", "=", 
        RowBox[{"field", "[", "\"\<dB2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "interpolation", " ", "onto", " ", "the", " ", "same", " ", 
         "coordinates"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x0", "=", 
        RowBox[{"Mean", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"dEy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"dEz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x2", ",", 
             RowBox[{"dBy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"x2", ",", 
             RowBox[{"dBz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
         "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t0", "=", 
        RowBox[{"t1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "3"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t1", ",", "dEy"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dEz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t1", ",", "dEz"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBy", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "dBy"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "dBz"}], "}"}], "]"}], "]"}], "[", "t0", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "Poynting", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EM", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dEy", "^", "2"}], "+", 
           RowBox[{"dBz", "^", "2"}], "+", 
           RowBox[{"dEz", "^", "2"}], "+", 
           RowBox[{"dBy", "^", "2"}]}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"k", " ", "c"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{
           RowBox[{"Pi", "/", "\[Omega]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t0", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"t0", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "//", "Round"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"meant0", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"t0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meanEM", "=", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"EM", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "EM"}], "}"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"meant0", ",", "meanEM"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", "Medium", "]"}], ",", "Dotted"}], 
                "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotLabels", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Text", "/@", 
              RowBox[{"Thread", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<W\>\"", ",", 
                   "\"\<\[LeftAngleBracket]W\[RightAngleBracket]\>\""}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Gray", ",", "Red"}], "}"}]}], "]"}], "]"}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Join", ",", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"$1", ",", "$2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"$1", ",", "$1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"$2", ",", "\"\<\>\""}], "}"}]}], "}"}]}], "]"}], 
               "@@@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Max", "[", "t0", "]"}], ",", "Pi"}], "]"}], ",", 
                 "2"}], "]"}]}]}], "]"}], ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\\!\\(t\[VeryThinSpace]\[Omega]\\)\>\"", ",", "None"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[850]:=",ExpressionUUID->"53dff2b0-67b4-4b8b-8b8c-9deae0fd430b"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-em_energy.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[851]:=",ExpressionUUID->"d17e4217-a025-40a2-ac22-8338c2aafc76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figures", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"field", "=", "field"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "t1", ",", "t2", ",", "x1", ",", "x2", ",", "dBz", ",", "dBy", ",", 
         "dEy", ",", "dEz", ",", "t0", ",", "x0", ",", "plots"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t1", "=", 
         RowBox[{"field", "[", "\"\<t1\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t2", "=", 
         RowBox[{"field", "[", "\"\<t2\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x1", "=", 
         RowBox[{"field", "[", "\"\<x1\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x2", "=", 
         RowBox[{"field", "[", "\"\<x2\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dEy", "=", 
         RowBox[{"field", "[", "\"\<dE2\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dEz", "=", 
         RowBox[{"field", "[", "\"\<dE3\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dBz", "=", 
         RowBox[{"field", "[", "\"\<dB3\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dBy", "=", 
         RowBox[{"field", "[", "\"\<dB2\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "interpolation", " ", "onto", " ", "the", " ", "same", " ", 
          "coordinates"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"x0", "=", 
         RowBox[{"Mean", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dEy", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"x1", ",", 
              RowBox[{"dEy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
          "x0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dEz", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"x1", ",", 
              RowBox[{"dEz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
          "x0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dBy", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"x2", ",", 
              RowBox[{"dBy", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
          "x0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dBz", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"x2", ",", 
              RowBox[{"dBz", "\[Transpose]"}]}], "}"}], "]"}], "]"}], "[", 
          "x0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"t0", "=", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Rest", "[", "t1", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "t1", "]"}], "/", "2"}], "//", 
            "Round"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dEy", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"t1", ",", "dEy"}], "}"}], "]"}], "]"}], "[", "t0", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dEz", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"t1", ",", "dEz"}], "}"}], "]"}], "]"}], "[", "t0", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dBy", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"t2", ",", "dBy"}], "}"}], "]"}], "]"}], "[", "t0", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dBz", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"t2", ",", "dBz"}], "}"}], "]"}], "]"}], "[", "t0", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t", ",", "E2", ",", "B2"}], "}"}], ",", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Red", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "E2"}], "}"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "B2"}], "}"}], 
                    "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Axes", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[DoubleStruckE]\), \
\(^\)], \(1\)]\)\>\"", ",", 
                  
                  "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[DoubleStruckE]\), \
\(^\)], \(2\)]\)\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "->", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ".7"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"PlotRangePadding", "\[Rule]", ".01"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Epilog", "\[Rule]", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"StringJoin", "[", 
                   RowBox[{"\"\<\\!\\(t\[VeryThinSpace]\[Omega]=\>\"", ",", 
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"t", ",", "3"}], "]"}], "]"}], ",", "\"\<.\>\""}],
                     "]"}], ",", "\"\<\\)\>\""}], "]"}], ",", 
                  RowBox[{"Scaled", "[", 
                   RowBox[{"{", 
                    RowBox[{".05", ",", ".95"}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t0", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"dEy", ",", "dEz"}], "}"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"dBy", ",", "dBz"}], "}"}], "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"ListAnimate", "[", 
          RowBox[{
           RowBox[{"Legended", "[", 
            RowBox[{"plots", ",", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{"LineLegend", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Red", ",", "Blue"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\[DoubleStruckCapitalE]\>\"", ",", 
                   "\"\<\[DoubleStruckCapitalB]\>\""}], "}"}]}], "]"}], ",", 
               "Right"}], "]"}]}], "]"}], "//", "Thread"}], "]"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Legended", "[", 
          RowBox[{"plots", ",", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"LineLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\[DoubleStruckCapitalE]\>\"", ",", 
                 "\"\<\[DoubleStruckCapitalB]\>\""}], "}"}], ",", 
               RowBox[{"LegendMargins", "\[Rule]", "0"}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], 
             ",", "Below"}], "]"}]}], "]"}], "//", "Thread"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[609]:=",ExpressionUUID->"2469886c-d7dd-4e57-8567-0100db310bbb"],

Cell[BoxData[
 RowBox[{"figures", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellLabel->
  "In[610]:=",ExpressionUUID->"799a64f3-d45c-44d7-9ff4-0f251c909efe"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-polarization.gif\>\""}]}], "}"}], "]"}], ",", "figures", ",", 
   RowBox[{"AnimationRepetitions", "->", "Infinity"}]}], "]"}]], "Input",
 CellLabel->
  "In[611]:=",ExpressionUUID->"89b479fd-a2bd-4c1d-99c1-f7a596f4b5e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prob 14.12", "Section",ExpressionUUID->"5c0ac464-6fd9-4048-af93-5cd0ff733c69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<.\>\"", ",", "\"\<03_prob_14_12\>\""}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[786]:=",ExpressionUUID->"c1dbdcc3-1a2c-48f2-878b-6b1ea6160aec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<field-*.csv\>\"", ",", "wd"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"path", ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"FileNameTake", "[", "path", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StringCases", "[", 
              RowBox[{"s", ",", 
               RowBox[{
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"i", ":", "NumberString"}], "~~", "\"\<.csv\>\""}], 
                "\[RuleDelayed]", 
                RowBox[{"ToExpression", "[", "i", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "assoc", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"importField", "[", "paths", "]"}], "]"}], ",", 
           "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"E", " ", "field", " ", "coordinates"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<x1\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"assoc", "[", "\"\<Nx\>\"", "]"}], "]"}], 
          RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<t1\>\"", "]"}], "=", 
         RowBox[{"assoc", "[", "\"\<time\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"B", " ", "field", " ", "grid", " ", "coordinates"}], ";", 
          " ", 
          RowBox[{"lagging", " ", "behind", " ", "by", " ", "half"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<x2\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<x1\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"assoc", "[", "\"\<Dx\>\"", "]"}], "/", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"assoc", "[", "\"\<t2\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"assoc", "[", "\"\<t1\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Subtract", "@@", 
              RowBox[{
               RowBox[{"assoc", "[", "\"\<time\>\"", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
           "2"}]}]}], ";", "\[IndentingNewLine]", "assoc"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[787]:=",ExpressionUUID->"558763d8-e4c2-4459-9a19-9e311aa1bc40"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "field"}]], "Input",
 CellLabel->
  "In[788]:=",ExpressionUUID->"47540753-ad8e-45fa-b84f-84b5e4c99dd3"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"field", "=", "field"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2", ",", "B2O2", ",", "E2O2", ",", "plots"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{"field", "[", "\"\<t1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"field", "[", "\"\<t2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E2O2", "=", 
        RowBox[{"Mean", "/@", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"field", "/@", 
              RowBox[{"{", 
               RowBox[{
               "\"\<dE1\>\"", ",", "\"\<dE2\>\"", ",", "\"\<dE3\>\""}], 
               "}"}]}], ",", "2"}], "]"}], "/", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B2O2", "=", 
        RowBox[{"Mean", "/@", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"field", "/@", 
              RowBox[{"{", 
               RowBox[{
               "\"\<dB1\>\"", ",", "\"\<dB2\>\"", ",", "\"\<dB3\>\""}], 
               "}"}]}], ",", "2"}], "]"}], "/", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"t1", ",", "E2O2"}], "}"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"t2", ",", "B2O2"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue"}], "}"}], ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SuperscriptBox[\(E\), \(2\)]\)/2\>\"", ",", 
                "\"\<\!\(\*SuperscriptBox[\(B\), \(2\)]\)/2\>\""}], "}"}], 
              ",", "Above"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\\!\\(t\[VeryThinSpace]\!\(\*SubscriptBox[\(\[Omega]\), \
\(pe\)]\)\\)\>\"", ",", 
            RowBox[{"StringJoin", "[", "\"\<\\!\\(Energy\\)\>\"", "]"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "5"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Max", "[", "t1", "]"}], ",", 
              RowBox[{"2", "Pi"}]}], "]"}], ",", "Automatic"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[790]:=",ExpressionUUID->"3aeeedfe-c4f7-4fbe-8cc8-583ade46c614"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-em_energy.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",ExpressionUUID->"3e89dfc1-a6c0-4c7a-adf1-01e74f6fe1ac"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"field", "=", "field"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", "t2", ",", "dBz", ",", "dEy", ",", "x1", ",", "x2", ",", 
        "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", "=", 
        RowBox[{
         RowBox[{"field", "[", "\"\<t1\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{
         RowBox[{"field", "[", "\"\<t2\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dEy", "=", 
        RowBox[{
         RowBox[{"field", "[", "\"\<dE2\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], ",", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBz", "=", 
        RowBox[{
         RowBox[{"field", "[", "\"\<dB3\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], ",", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{
         RowBox[{"field", "[", "\"\<x1\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x2", "=", 
        RowBox[{
         RowBox[{"field", "[", "\"\<x2\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plots", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Apply", "[", 
                   RowBox[{"Join", ",", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"$1", ",", "$2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"$1", ",", "$1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"$2", ",", "\"\<\>\""}], "}"}]}], "}"}]}], "]"}], 
                    "@@@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}]}], "]"}], ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"#", ",", "Null"}], "}"}], "]"}]}], "}"}], "&"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Max", "[", "t1", "]"}], ",", 
                   RowBox[{"2", "Pi"}]}], "]"}], ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Max", "[", "x1", "]"}], ",", 
                   RowBox[{"2", "Pi"}]}], "]"}]}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"BaseStyle", "\[Rule]", "13"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\\!\\(x\[VeryThinSpace]k\\)\>\"", ",", 
               "\"\<\\!\\(t\[VeryThinSpace]\[Omega]\\)\>\""}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRangePadding", "\[Rule]", 
             RowBox[{"Scaled", "[", ".02", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImagePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "1"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dEy", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"x1", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                RowBox[{"t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SubscriptBox[\(E\), \(y\)]\)(x,t)\\)\>\"", 
                ",", "13"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dBz", "//", "Reverse"}], ",", "\[IndentingNewLine]", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"x2", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                RowBox[{"t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SubscriptBox[\(B\), \(z\)]\)(x,t)\\)\>\"", 
                ",", "13"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"plots", ",", 
         RowBox[{"Spacer", "[", "5", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[751]:=",ExpressionUUID->"3bd2888f-0144-4860-9bd2-b694bbca495d"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figdir", ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", "wd", "]"}], "<>", 
       "\"\<-em_wave_fronts.png\>\""}]}], "}"}], "]"}], ",", "dynamic"}], 
  "]"}]], "Input",
 CellLabel->
  "In[752]:=",ExpressionUUID->"a2a6587b-a870-412c-810d-5f5bfaca3284"]
}, Closed]]
},
WindowSize->{933, 817},
WindowMargins->{{Automatic, -1714}, {1, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 257, 5, 52, "Input",ExpressionUUID->"6b3b9c34-f330-4460-8d60-2807c4d0ace9"],
Cell[818, 27, 271, 8, 30, "Input",ExpressionUUID->"a6a13c5d-4baa-4bb4-88a5-9292453a6135"],
Cell[CellGroupData[{
Cell[1114, 39, 89, 0, 54, "Subsection",ExpressionUUID->"e128867d-f81c-4723-a5f3-00f9a32a5b13"],
Cell[1206, 41, 1797, 45, 241, "Input",ExpressionUUID->"d78cce98-3a82-4785-85db-8be2519bd616"],
Cell[3006, 88, 2256, 56, 262, "Input",ExpressionUUID->"832b9a46-ac29-42bb-9d5f-ba56a5964cbf"],
Cell[5265, 146, 4871, 122, 514, "Input",ExpressionUUID->"984258eb-365b-4048-ab10-6220b1896c2a"]
}, Closed]],
Cell[CellGroupData[{
Cell[10173, 273, 83, 0, 53, "Section",ExpressionUUID->"408cddcc-c4f7-4e7f-8f25-3f2b402028b8"],
Cell[10259, 275, 272, 8, 30, "Input",ExpressionUUID->"1d807801-045b-46c9-8864-a72423a29aea"],
Cell[10534, 285, 3631, 91, 388, "Input",ExpressionUUID->"a30634d5-bc78-43a7-8120-ee203a4937db"],
Cell[14168, 378, 146, 3, 30, "Input",ExpressionUUID->"79c5add7-dce5-47c8-bdd1-c85bbb07346c"],
Cell[14317, 383, 7797, 187, 763, "Input",ExpressionUUID->"4e2a2444-093f-425e-8852-131b204fca99"],
Cell[22117, 572, 377, 11, 30, "Input",ExpressionUUID->"560b4260-daf5-4cdc-8346-5260de6b8265"],
Cell[22497, 585, 7111, 175, 808, "Input",ExpressionUUID->"26f5a75f-e38d-41f5-ad29-cd22d4ba8b22"],
Cell[29611, 762, 378, 11, 30, "Input",ExpressionUUID->"1536e61f-bf60-4453-a682-655617b74852"],
Cell[29992, 775, 7185, 180, 808, "Input",ExpressionUUID->"6e45cc95-24d0-469c-b8e8-d0093c10c97d"],
Cell[37180, 957, 372, 11, 30, "Input",ExpressionUUID->"9fbba661-1d12-49dd-b41c-0f80c40a2e7d"]
}, Closed]],
Cell[CellGroupData[{
Cell[37589, 973, 90, 0, 53, "Section",ExpressionUUID->"960d2089-6b68-4135-a2e5-0a45c397a349"],
Cell[37682, 975, 272, 8, 30, "Input",ExpressionUUID->"47a811b6-f9ee-471d-9699-4022b0bfc356"],
Cell[37957, 985, 3631, 91, 388, "Input",ExpressionUUID->"75e361ae-7b0d-4d05-897a-75e20fc725d9"],
Cell[41591, 1078, 146, 3, 30, "Input",ExpressionUUID->"0a552b45-bdaf-46ee-a733-e033e7a129ae"],
Cell[41740, 1083, 8004, 201, 892, "Input",ExpressionUUID->"6466da60-931e-4aa0-999c-605e2d54736e"],
Cell[49747, 1286, 378, 11, 30, "Input",ExpressionUUID->"1ac27bb3-b142-4f1f-83fc-73d619927664"],
Cell[50128, 1299, 8678, 219, 934, "Input",ExpressionUUID->"53dff2b0-67b4-4b8b-8b8c-9deae0fd430b"],
Cell[58809, 1520, 372, 11, 30, "Input",ExpressionUUID->"d17e4217-a025-40a2-ac22-8338c2aafc76"],
Cell[59184, 1533, 9636, 234, 885, "Input",ExpressionUUID->"2469886c-d7dd-4e57-8567-0100db310bbb"],
Cell[68823, 1769, 166, 4, 30, "Input",ExpressionUUID->"799a64f3-d45c-44d7-9ff4-0f251c909efe"],
Cell[68992, 1775, 433, 11, 52, "Input",ExpressionUUID->"89b479fd-a2bd-4c1d-99c1-f7a596f4b5e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69462, 1791, 84, 0, 67, "Section",ExpressionUUID->"5c0ac464-6fd9-4048-af93-5cd0ff733c69"],
Cell[69549, 1793, 273, 8, 30, "Input",ExpressionUUID->"c1dbdcc3-1a2c-48f2-878b-6b1ea6160aec"],
Cell[69825, 1803, 3631, 91, 388, "Input",ExpressionUUID->"558763d8-e4c2-4459-9a19-9e311aa1bc40"],
Cell[73459, 1896, 146, 3, 30, "Input",ExpressionUUID->"47540753-ad8e-45fa-b84f-84b5e4c99dd3"],
Cell[73608, 1901, 3957, 97, 492, "Input",ExpressionUUID->"3aeeedfe-c4f7-4fbe-8cc8-583ade46c614"],
Cell[77568, 2000, 344, 9, 30, "Input",ExpressionUUID->"3e89dfc1-a6c0-4c7a-adf1-01e74f6fe1ac"],
Cell[77915, 2011, 7615, 186, 763, "Input",ExpressionUUID->"3bd2888f-0144-4860-9bd2-b694bbca495d"],
Cell[85533, 2199, 377, 11, 30, "Input",ExpressionUUID->"a2a6587b-a870-412c-810d-5f5bfaca3284"]
}, Closed]]
}
]
*)

